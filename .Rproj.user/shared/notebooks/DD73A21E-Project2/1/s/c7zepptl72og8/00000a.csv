"0","##Class_diag function "
"0","class_diag<-function(probs,truth){"
"0","  "
"0","  tab<-table(factor(probs>.5,levels=c(""FALSE"",""TRUE"")),truth)"
"0","  acc=sum(diag(tab))/sum(tab)"
"0","  sens=tab[2,2]/colSums(tab)[2]"
"0","  spec=tab[1,1]/colSums(tab)[1]"
"0","  ppv=tab[2,2]/rowSums(tab)[2]"
"0",""
"0","  if(is.numeric(truth)==FALSE & is.logical(truth)==FALSE) truth<-as.numeric(truth)-1"
"0","  "
"0","  #CALCULATE EXACT AUC"
"0","  ord<-order(probs, decreasing=TRUE)"
"0","  probs <- probs[ord]; truth <- truth[ord]"
"0","  "
"0","  TPR=cumsum(truth)/max(1,sum(truth)) "
"0","  FPR=cumsum(!truth)/max(1,sum(!truth))"
"0","  "
"0","  dup<-c(probs[-1]>=probs[-length(probs)], FALSE)"
"0","  TPR<-c(0,TPR[!dup],1); FPR<-c(0,FPR[!dup],1)"
"0","  "
"0","  n <- length(TPR)"
"0","  auc<- sum( ((TPR[-1]+TPR[-n])/2) * (FPR[-1]-FPR[-n]) )"
"0",""
"0","  data.frame(acc,sens,spec,ppv,auc)"
"0","}"
"0",""
"0",""
"0",""
"0",""
"0","odds<-function(p)p/(1-p)"
"0","p<-seq(0,1,by=.1)"
"0",""
"0",""
"0",""
"0","fit2<- glm(Acceptance~MCAT + GPA + BCPM, data = MedGPA, family = binomial(link = ""logit""))"
"0","coeftest(fit2)"
"1","
z test of coefficients:

"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," z value"
"1","  Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1"," -22.54084"
"1","    6.65960"
"1"," -3.3847"
"1"," 0.0007125"
"1"," ***"
"1","
MCAT       "
"1","   0.16351"
"1","    0.10328"
"1","  1.5833"
"1"," 0.1133617"
"1","    "
"1","
GPA        "
"1","   5.08566"
"1","    4.26017"
"1","  1.1938"
"1"," 0.2325685"
"1","    "
"1","
BCPM       "
"1","  -0.35737"
"1","    3.42334"
"1"," -0.1044"
"1"," 0.9168575"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"0","exp(coef(fit2))"
"1"," (Intercept) "
"1","        MCAT "
"1","         GPA "
"1","        BCPM "
"1","
"
"1","1.624190e-10 "
"1","1.177640e+00 "
"1","1.616864e+02 "
"1","6.995122e-01 "
"1","
"
"0","prob<- predict(fit2, type = ""response"")"
"0","class_diag(prob, MedGPA$Acceptance)"
